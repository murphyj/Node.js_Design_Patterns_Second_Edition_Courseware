'use strict';

class Calculator {
  constructor(code, consumer) {
      this.code = code;

      consumer
        .on('stock_updated', price => {
          // console.log("stock_update event fired for ", price);

          this.calc(price)
        })
        .on('error', err => console.log(`Error emitted ${err.message}`));
  }

  calc (price) {
    let calcOutput = '';

    if (price.open > price.previous.open) {
      calcOutput += 'UP ';
    } else {
      calcOutput += 'DOWN ';
    }

    let percentageChange = ((100 - (100/price.close) * price.previous.close) * -1).toFixed(2) + '%';
    calcOutput += percentageChange + ' ';

    calcOutput += price.close;

    console.log(calcOutput);
  }
}

module.exports = Calculator;
